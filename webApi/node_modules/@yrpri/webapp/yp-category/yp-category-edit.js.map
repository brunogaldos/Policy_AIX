{"version":3,"file":"yp-category-edit.js","sourceRoot":"","sources":["../../src/yp-category/yp-category-edit.ts"],"names":[],"mappings":"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","sourcesContent":["import { html, css, nothing } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\n\nimport \"../yp-edit-dialog/yp-edit-dialog.js\";\nimport \"../yp-file-upload/yp-file-upload.js\";\n\nimport { YpEditBase } from \"../common/yp-edit-base.js\";\nimport { YpFileUpload } from \"../yp-file-upload/yp-file-upload.js\";\nimport { YpConfirmationDialog } from \"../yp-dialog-container/yp-confirmation-dialog.js\";\n\n@customElement(\"yp-category-edit\")\nexport class YpCategoryEdit extends YpEditBase {\n  @property({ type: Object })\n  category: YpCategoryData | undefined;\n\n  @property({ type: Object })\n  group!: YpGroupData;\n\n  @property({ type: Number })\n  uploadedIconImageId: number | undefined;\n\n  @property({ type: Object })\n  deletedFunction: Function | undefined;\n\n  @property({ type: String })\n  action = \"/categories\";\n\n  static override get styles() {\n    return [\n      super.styles,\n      css`\n        md-outlined-text-field {\n          margin-bottom: 16px;\n        }\n\n        .deleteButton {\n          --md-sys-color-primary: var(--md-sys-color-error);\n        }\n      `,\n    ];\n  }\n\n  override render() {\n    return html`\n      <yp-edit-dialog\n        id=\"editDialog\"\n        .title=\"${this.editHeaderText!}\"\n        icon=\"category\"\n        .action=\"${this.action}\"\n        method=\"${this.method}\"\n        .saveText=\"${this.saveText}\"\n        .snackbarText=\"${this.snackbarText}\"\n      >\n        <h2 slot=\"h2\">${this.editHeaderText}</h2>\n        <md-outlined-text-field\n          id=\"name\"\n          name=\"name\"\n          type=\"text\"\n          label=\"${this.t(\"name\")}\"\n          .value=\"${this.category?.name || \"\"}\"\n          maxlength=\"60\"\n          charCounter\n          class=\"mainInput\"\n        ></md-outlined-text-field>\n        <yp-file-upload\n          id=\"iconImageUpload\"\n          raised\n          buttonIcon=\"photo_camera\"\n          .buttonText=\"${this.t(\"image.logo.upload\")}\"\n          target=\"/api/images?itemType=category-icon\"\n          method=\"POST\"\n          @success=\"${this._logoImageUploaded}\"\n        ></yp-file-upload>\n        ${this.uploadedIconImageId\n          ? html`<input\n              type=\"hidden\"\n              name=\"uploadedIconImageId\"\n              .value=\"${this.uploadedIconImageId}\"\n            />`\n          : nothing}\n\n        ${!this.new\n          ? html`<md-text-button\n              slot=\"actions\"\n              class=\"deleteButton\"\n              @click=\"${this._deleteCategory}\"\n              >${this.t(\"deleteCategory\")}</md-text-button\n            >`\n          : nothing}\n      </yp-edit-dialog>\n    `;\n  }\n\n  clear() {\n    this.category = { id: -1, name: \"\", count: 0 } as YpCategoryData;\n    this.uploadedIconImageId = undefined;\n    (this.$$(\"#iconImageUpload\") as YpFileUpload)?.clear();\n  }\n\n  _deleteCategory() {\n    window.appDialogs.getDialogAsync(\n      \"confirmationDialog\",\n      (dialog: YpConfirmationDialog) => {\n        dialog.open(\n          this.t(\"deleteCategory\"),\n          this._reallyDeleteCategory.bind(this),\n          false,\n          true\n        );\n      }\n    );\n  }\n\n  async _reallyDeleteCategory() {\n    if (this.category) {\n      await window.adminServerApi.deleteCategory(this.category.id);\n      if (typeof this.deletedFunction === \"function\") {\n        this.deletedFunction(this.category);\n      }\n      this.close();\n      window.appGlobals.notifyUserViaToast(this.t(\"categoryDeleted\"));\n    }\n  }\n\n  setup(\n    group: YpGroupData,\n    newNotEdit: boolean,\n    refreshFunction: Function,\n    deletedFunction: Function,\n    category?: YpCategoryData\n  ) {\n    this.group = group;\n    this.new = newNotEdit;\n    this.refreshFunction = refreshFunction;\n    this.deletedFunction = deletedFunction;\n    this.category = category ? { ...category } : { id: -1, name: \"\", count: 0 };\n    if (category) {\n      this.action = `/categories/${category.id}`;\n    } else {\n      this.action = `/groups/${this.group.id}/categories`;\n    }\n    this.setupTranslation();\n  }\n\n  setupTranslation() {\n    if (this.new) {\n      this.editHeaderText = this.t(\"New category\");\n      this.snackbarText = this.t(\"category.toast.created\");\n      this.saveText = this.t(\"create\");\n    } else {\n      this.editHeaderText = this.t(\"Update category info\");\n      this.snackbarText = this.t(\"category.toast.updated\");\n      this.saveText = this.t(\"update\");\n    }\n  }\n}\n"]}