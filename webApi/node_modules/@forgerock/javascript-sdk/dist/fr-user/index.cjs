"use strict";const s=require("../util/logger.cjs"),o=require("../oauth2-client/index.cjs"),c=require("../session-manager/index.cjs"),u=require("../token-manager/index.cjs"),g=require("../config/index.cjs"),d=require("../token-storage/index.cjs");class l{static async login(e,r){throw s.FRLogger.info(e,r),new Error("FRUser.login() not implemented")}static async logout(e){const r={...e};delete r.redirect;const{serverConfig:t}=g.get(r);if(!t.paths||t.paths&&"sessions"in t.paths)try{await c.logout(r)}catch{s.FRLogger.warn("Session logout was not successful")}if(e?.redirect===!1)try{await o.default.endSession({...e})}catch{s.FRLogger.warn("OAuth endSession was not successful")}try{await o.default.revokeToken(r)}catch{s.FRLogger.warn("OAuth revokeToken was not successful")}const a=await d.get(),{idToken:i=""}=a||{};if(await u.deleteTokens(),e?.redirect!==!1)try{await o.default.endSession({...e,idToken:i})}catch{s.FRLogger.warn("OAuth endSession was not successful")}}}module.exports=l;
