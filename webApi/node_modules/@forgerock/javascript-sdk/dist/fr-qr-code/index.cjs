"use strict";const u=require("../auth/enums.cjs");class C{static isQRCodeStep(t){const e=t.getCallbacksOfType(u.CallbackType.HiddenValueCallback);return e.length===0?!1:!!this.getQRCodeURICb(e)}static getQRCodeData(t){const e=t.getCallbacksOfType(u.CallbackType.HiddenValueCallback);if(e.length===0)throw new Error("QR Code step must contain a HiddenValueCallback. Use `FRQRCode.isQRCodeStep` to guard.");const a=this.getQRCodeURICb(e),s=a?a.getOutputValue("value"):"",n=typeof s=="string"&&s.includes("otpauth://")?"otp":"push",l=t.getCallbacksOfType(u.CallbackType.TextOutputCallback).find(o=>o.getMessageType()!=="4");return{message:l?l.getMessage():"",use:n,uri:typeof s=="string"?s:""}}static getQRCodeURICb(t){return t.find(e=>{const a=e.getOutputValue("value");return typeof a=="string"?a?.includes("otpauth://")||a?.includes("pushauth://"):!1})}}module.exports=C;
