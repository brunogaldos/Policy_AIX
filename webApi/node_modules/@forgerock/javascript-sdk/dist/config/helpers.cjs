"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const l=require("../util/middleware.cjs"),u=require("../util/timeout.cjs"),w=require("./enums.cjs");function c(e,r){if(!e.authorization_endpoint)throw new Error("Wellknown endpoint did not return `authorization_endpoint`");const t=new URL(e.authorization_endpoint).origin;let n,i;e.issuer.includes("/am/")?(n=`${e.issuer.replace("oauth2","json")}/authenticate`,i=`${e.issuer.replace("oauth2","json")}/sessions`):e.issuer.includes("/as/");const s={...n?{authenticate:new URL(n).pathname}:{},authorize:new URL(e.authorization_endpoint).pathname,accessToken:new URL(e.token_endpoint).pathname,endSession:new URL(e.ping_end_idp_session_endpoint||e.end_session_endpoint).pathname,userInfo:new URL(e.userinfo_endpoint).pathname,revoke:new URL(e.revocation_endpoint).pathname,...i?{sessions:new URL(i).pathname}:{}};return{baseUrl:t,paths:s}}async function a(e){if(!e.serverConfig.wellknown)throw new Error("wellknown URL is missing in options");const o=l({url:new URL(e.serverConfig?.wellknown),init:{method:"GET"}},{type:w.ActionTypes.WellKnown,payload:{}})(e.middleware);return await(await u.withTimeout(fetch(o.url.toString(),o.init),e.serverConfig.timeout)).json()}exports.convertWellKnown=c;exports.fetchWellKnown=a;
