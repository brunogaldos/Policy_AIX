{"version":3,"file":"ps-raw-evidence.js","sourceRoot":"","sources":["../../src/policies/ps-raw-evidence.ts"],"names":[],"mappings":"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","sourcesContent":["import { css, html, nothing } from 'lit';\nimport { property, customElement, eventOptions } from 'lit/decorators.js';\n\nimport '@yrpri/webapp/common/yp-image.js';\nimport '@material/web/select/outlined-select.js';\nimport '@material/web/select/select-option.js';\nimport '@material/web/iconbutton/outlined-icon-button.js';\nimport '@material/web/iconbutton/filled-icon-button.js';\n\nimport '@material/web/progress/circular-progress.js';\nimport '@material/web/button/text-button.js';\n\nimport { PsStageBase } from '../base/ps-stage-base.js';\nimport { Layouts } from '../flexbox-literals/classes.js';\nimport { YpBaseElement } from '@yrpri/webapp/common/yp-base-element.js';\n\n@customElement('ps-raw-evidence')\nexport class PsRawEvidence extends YpBaseElement {\n  @property({ type: Object })\n  memory: PsBaseMemoryData;\n\n  @property({ type: Object })\n  policy!: PSPolicy;\n\n  @property({ type: Number })\n  activeSubProblemIndex!: number;\n\n  @property({ type: Array })\n  activeRawEvidence!: PSEvidenceRawWebPageData[];\n\n  @property({ type: Object })\n  groupedRawEvidence: Record<string, PSEvidenceRawWebPageData[]> = {};\n\n  @property({ type: Boolean })\n  loading = true;\n\n  @property({ type: Boolean })\n  showDropdown = false;\n\n  @property({ type: Object })\n  showFullList: Record<string, boolean> = {};\n\n  @eventOptions({ passive: true })\n  handleScroll() {\n    if (window.scrollY >= 550) {\n      this.showDropdown = true;\n    } else {\n      this.showDropdown = false;\n    }\n    this.requestUpdate();\n  }\n\n  async connectedCallback() {\n    super.connectedCallback();\n    window.psAppGlobals.activity(`Raw evidence - open`);\n    window.addEventListener('scroll', this.handleScroll.bind(this));\n  }\n\n  updated(changedProperties: Map<string | number | symbol, unknown>): void {\n    super.updated(changedProperties);\n\n    if (\n      (changedProperties.has('activeSubProblemIndex') ||\n        changedProperties.has('policy')) &&\n      this.activeSubProblemIndex !== undefined &&\n      this.policy !== undefined\n    ) {\n      if (\n        PsRawEvidence.rawPolicyCache[\n          `${this.activeSubProblemIndex}-${this.policy.title}`\n        ]\n      ) {\n        this.activeRawEvidence =\n          PsRawEvidence.rawPolicyCache[\n            `${this.activeSubProblemIndex}-${this.policy.title}`\n          ];\n        this.setupRawEvidence();\n      } else {\n        this.loading = true;\n        this.activeRawEvidence = null;\n        this.loadRawEvidence();\n      }\n    }\n  }\n\n  setupRawEvidence() {\n    this.groupedRawEvidence = {};\n    this.activeRawEvidence.forEach(evidence => {\n      if (!this.groupedRawEvidence[evidence.searchType]) {\n        this.groupedRawEvidence[evidence.searchType] = [];\n      }\n      this.groupedRawEvidence[evidence.searchType].push(evidence);\n    });\n\n    // Sort each group by totalScore, in descending order\n    for (const searchType in this.groupedRawEvidence) {\n      this.groupedRawEvidence[searchType].sort((a, b) => {\n        return (b.totalScore ?? 0) - (a.totalScore ?? 0);\n      });\n    }\n\n    this.loading = false;\n  }\n\n  disconnectedCallback(): void {\n    super.disconnectedCallback();\n    window.psAppGlobals.activity(`Raw evidence - close`);\n    window.removeEventListener('scroll', this.handleScroll.bind(this));\n  }\n\n  formatSearchType(searchType: string) {\n    // Insert a space before all capital letters, then capitalize the first letter\n    const formatted = searchType.replace(/([A-Z])/g, ' $1').trim();\n    return formatted.charAt(0).toUpperCase() + formatted.slice(1);\n  }\n\n  async loadRawEvidence() {\n    const rawEvidence = (await window.psServerApi.getRawEvidence(\n      this.memory.groupId,\n      this.activeSubProblemIndex,\n      this.policy.title\n    )) as PSEvidenceRawWebPageData[];\n\n    PsRawEvidence.rawPolicyCache[\n      `${this.activeSubProblemIndex}-${this.policy.title}`\n    ] = rawEvidence;\n\n    this.activeRawEvidence = rawEvidence;\n    this.setupRawEvidence();\n  }\n\n  static get styles() {\n    return [\n      super.styles,\n      Layouts,\n      css`\n        .loading {\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          width: 100%;\n          height: 100vh;\n        }\n\n        .title {\n          font-family: 'Roboto Condensed', sans-serif;\n          font-size: 32px;\n          margin-bottom: 8px;\n          color: var(--md-sys-color-primary);\n          background-color: var(--md-sys-color-on-primary);\n          text-align: center;\n          padding: 16px;\n          border-radius: 16px;\n          max-width: 960px;\n          margin-top: 32px;\n          width: 100%;\n        }\n\n        .listTitle {\n          font-family: 'Roboto Condensed', sans-serif;\n          font-size: 26px;\n          color: var(--md-sys-color-secondary);\n          background-color: var(--md-sys-color-on-secondary);\n          text-align: center;\n          padding: 16px;\n          max-width: 400px;\n          margin: 16px;\n          border-radius: 12px;\n        }\n\n        .fade-in {\n          animation: fadeIn ease 1s;\n        }\n\n        @keyframes fadeIn {\n          0% {\n            opacity: 0;\n          }\n          100% {\n            opacity: 1;\n          }\n        }\n\n        md-outlined-select::part(menu) {\n          max-height: 500px;\n          height: 500px;\n        }\n\n        md-outlined-select {\n          max-width: 230px;\n        }\n\n        .jumpToPolicyTitle {\n          max-width: 200px;\n          margin-bottom: 24px;\n        }\n\n        .listItem {\n          text-align: left;\n          padding: 8px;\n          font-size: 20px;\n          color: var(--md-sys-color-on-surface);\n        }\n\n        .dropdown {\n          position: fixed;\n          bottom: 64px;\n          left: 16px;\n          z-index: 1000;\n        }\n\n        .url {\n          font-size: 18px;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          max-width: 350px;\n          color: var(--md-sys-color-on-surface);\n          margin-top: 8px;\n        }\n\n        .rawEvidenceContainer {\n          background-color: var(--md-sys-color-surface-container-low);\n          color: var(--md-sys-color-on-surface);\n          margin: 16px;\n          padding: 16px;\n        }\n\n        .evidenceItem {\n          max-width: 420px;\n          margin: 16px;\n          align-self: start;\n        }\n\n        .header {\n          margin-bottom: 20px;\n        }\n\n        .meta-description {\n          max-width: 600px;\n        }\n\n        .topEvidencePiece {\n          border-bottom: 5px dashed var(--md-sys-color-primary);\n          padding-bottom: 24px;\n          margin-bottom: 24px;\n        }\n\n        .header-title {\n          font-size: 24px;\n          font-weight: bold;\n          max-width: 600px;\n          margin-bottom: 8px;\n        }\n\n        .header-meta {\n          display: flex;\n          flex-direction: row;\n          align-items: center;\n        }\n\n        .meta-description,\n        .meta-author,\n        .meta-date,\n        .meta-publisher {\n          margin: 8px;\n          font-size: 20px;\n        }\n\n        .logoImage {\n          height: 125px;\n          max-width: 600px;\n          margin: 8px;\n        }\n\n        .shareImage {\n          height: 275px;\n          max-width: 800px;\n          margin: 8px;\n          margin-bottom: 8px;\n        }\n\n        a {\n          font-size: 18px;\n        }\n\n        .hidden {\n          display: none;\n        }\n\n        @media (max-width: 960px) {\n          .title {\n            margin-top: 16px;\n            max-width: 100%;\n            margin-right: 8px;\n            margin-left: 8px;\n            font-size: 26px;\n            border-radius: 16px;\n            max-width: 100%;\n          }\n        }\n      `,\n    ];\n  }\n\n  renderHeader(evidence: PSEvidenceRawWebPageData) {\n    return html`\n      <div class=\"header layout vertical center-center\">\n        <div class=\"header-meta layout vertical\">\n          <div class=\"layout vertical center-center\">\n            ${evidence.metaLogoUrl\n              ? html`<img\n                  class=\"logoImage\"\n                  loading=\"lazy\"\n                  src=\"${evidence.metaLogoUrl}\"\n                  alt=\"Logo\"\n                />`\n              : nothing}\n            ${evidence.metaImageUrl\n              ? html`<img\n                  class=\"shareImage\"\n                  loading=\"lazy\"\n                  src=\"${evidence.metaImageUrl}\"\n                  alt=\"Image\"\n                />`\n              : nothing}\n            <div ?hidden=\"${!evidence.metaTitle}\" class=\"header-title\">\n              ${evidence.metaTitle}\n            </div>\n          </div>\n          ${evidence.summary\n            ? html`<div class=\"meta-description\">${evidence.summary}</div>`\n            : nothing}\n          ${evidence.metaDate\n            ? html`<div hidden class=\"meta-date\">${evidence.metaDate}</div>`\n            : nothing}\n          <a class=\"url\" href=\"${evidence.url}\" target=\"_blank\"\n            >${evidence.url}</a\n          >\n        </div>\n      </div>\n    `;\n  }\n\n  scrollToEvidenceType(evidenceType: string) {\n    const element = this.$$('#' + evidenceType);\n    if (element) {\n      element.scrollIntoView({ behavior: 'smooth' });\n    }\n  }\n\n  renderDropdown() {\n    return html`\n      <div class=\"dropdown ${this.showDropdown ? '' : 'hidden'}\">\n        <div class=\"jumpToPolicyTitle\">${this.policy.title}</div>\n        <md-outlined-select\n          label=\"Jump to Evidence Type ...\"\n          .quick=${true}\n          .required=${false}\n          .disabled=${false}\n          @change=${(e: Event) =>\n            this.scrollToEvidenceType((e.target as HTMLSelectElement).value)}\n        >\n          ${Object.keys(this.groupedRawEvidence).map(\n            evidenceType => html`<md-select-option\n              .value=\"${evidenceType}\"\n              .headline=\"${this.camelCaseToRegular(evidenceType)}\"\n            ></md-select-option>`\n          )}\n        </md-outlined-select>\n      </div>\n    `;\n  }\n\n  renderPieceOfEvidence(evidence: PSEvidenceRawWebPageData) {\n    return html`<div class=\"layout vertical topEvidencePiece\">\n      ${this.renderHeader(evidence)}\n      <div class=\"layout horizontal center-center wrap\">\n        ${this.renderShortList(\n          evidence.url,\n          'Policy Recommendations',\n          evidence.whatPolicyNeedsToImplementInResponseToEvidence\n        )}\n        ${this.renderShortList(\n          evidence.url,\n          'Evidence Collected (unproven)',\n          evidence.mostImportantPolicyEvidenceInTextContext\n        )}\n        ${this.renderShortList(\n          evidence.url,\n          'Policy Risks',\n          evidence.risksForPolicy\n        )}\n        ${this.renderShortList(\n          evidence.url,\n          'Pros for Policy from source',\n          evidence.prosForPolicyFoundInTextContext\n        )}\n        ${this.renderShortList(\n          evidence.url,\n          'Cons for Policy from source',\n          evidence.consForPolicyFoundInTextContext\n        )}\n        ${this.renderShortList(\n          evidence.url,\n          'Academic Sources',\n          evidence.evidenceOrganizationSources\n        )}\n        ${this.renderShortList(\n          evidence.url,\n          'Organization Sources',\n          evidence.evidenceAcademicSources\n        )}\n      </div>\n    </div>`;\n  }\n\n  camelCaseToRegular(text: string) {\n    let result = text.replace(/([A-Z])/g, ' $1');\n    return result.charAt(0).toUpperCase() + result.slice(1);\n  }\n\n  renderShortList(url: string, title: string, list: string[]) {\n    if (!list || list.length === 0) {\n      return nothing;\n    } else {\n      const maxShortListToShowInitially = 3;\n      const showKey = `${url}-${title}`;\n      const isFullListShown = this.showFullList[showKey] || false;\n      const itemsToShow = isFullListShown\n        ? list\n        : list.slice(0, maxShortListToShowInitially);\n\n      return html`<div class=\"evidenceItem\">\n        <div class=\"listTitle\">${title}</div>\n        <div>\n          ${itemsToShow.map(\n            (item, index) =>\n              html` <div class=\"listItem\">${index + 1}. ${item}</div>`\n          )}\n        </div>\n        ${list.length > maxShortListToShowInitially\n          ? html`\n              <md-text-button @click=${() => this.toggleShowFullList(showKey)}>\n                ${isFullListShown\n                  ? this.t('Less')\n                  : `${this.t('More')} (${\n                      list.length - maxShortListToShowInitially\n                    })`}\n              </md-text-button>\n            `\n          : nothing}\n      </div>`;\n    }\n  }\n\n  toggleShowFullList(key: string) {\n    this.showFullList = {\n      ...this.showFullList,\n      [key]: !this.showFullList[key],\n    };\n    this.requestUpdate();\n  }\n\n  renderActiveRawEvidence() {\n    return html` ${this.renderDropdown()}\n      <div class=\"layout vertical center-center\">\n        ${Object.keys(this.groupedRawEvidence).map(\n          searchType => html`\n            <div id=\"${searchType}\" class=\"title\">\n              ${this.formatSearchType(searchType)}\n            </div>\n\n            <div class=\"rawEvidenceContainer layout vertical center-center\">\n              ${this.groupedRawEvidence[searchType].map(evidence =>\n                this.renderPieceOfEvidence(evidence)\n              )}\n            </div>\n          `\n        )}\n      </div>`;\n  }\n\n  render() {\n    if (this.loading) {\n      return html`<div class=\"loading\">\n        <md-circular-progress indeterminate></md-circular-progress>\n      </div>`;\n    } else if (this.activeRawEvidence) {\n      return this.renderActiveRawEvidence();\n    } else {\n      return nothing;\n    }\n  }\n\n  static rawPolicyCache: Record<string, PSEvidenceRawWebPageData[]> = {};\n}\n"]}